{"ast":null,"code":"import _regeneratorRuntime from\"/Users/derek/Desktop/project/JoinMe-fe-DerekLarm/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/derek/Desktop/project/JoinMe-fe-DerekLarm/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/derek/Desktop/project/JoinMe-fe-DerekLarm/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useEffect}from\"react\";import{Button,Navbar,Modal,Dropdown}from\"react-bootstrap\";import{GoogleMap,useLoadScript,Marker,InfoWindow}from\"@react-google-maps/api\";// import { formatRelative } from \"date-fns\";\nimport mapStyles from\"../mapStyles\";import{Paginations,EventModal,PaginationLink,LeftNav}from\"./index\";// import App from \"../App\";\nimport usePlacesAutocomplete,{getGeocode,getLatLng}from\"use-places-autocomplete\";import{Combobox,ComboboxInput,ComboboxPopover,ComboboxList,ComboboxOption}from\"@reach/combobox\";import\"@reach/combobox/styles.css\";import moment from\"moment\";var libraries=[\"places\"];var mapContainerStyle={width:\"100%\",height:\"100vh\"};var center={lat:10.785478,lng:106.696847};var options={styles:mapStyles,disableDefaultUI:true,zoomControl:true,disableDoubleClickZoom:true};export default function Map(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(10.785478),_useState4=_slicedToArray(_useState3,2),lat=_useState4[0],setLat=_useState4[1];var _useState5=useState(106.696847),_useState6=_slicedToArray(_useState5,2),lng=_useState6[0],setLng=_useState6[1];var handleShow=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setLat(e.latLng.lat());case 2:_context.next=4;return setLng(e.latLng.lng());case 4:setShow(true);// reverseGeo();\ncase 5:case\"end\":return _context.stop();}}},_callee);}));return function handleShow(_x){return _ref.apply(this,arguments);};}();var searchShow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLat(e.lat);setLng(e.lng);setShow(true);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function searchShow(_x2){return _ref2.apply(this,arguments);};}();var handleClose=function handleClose(){setShow(false);};var _useLoadScript=useLoadScript({googleMapsApiKey:process.env.REACT_APP_API_KEY,libraries:libraries}),isLoaded=_useLoadScript.isLoaded,loadError=_useLoadScript.loadError;var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),coordinates=_useState8[0],setCoordinates=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selected=_useState10[0],setSelected=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),rightClick=_useState12[0],setRightClick=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),id=_useState14[0],setId=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),eventList=_useState16[0],setEventList=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),modalEvents=_useState18[0],setModalEvents=_useState18[1];var _useState19=useState(1),_useState20=_slicedToArray(_useState19,2),pageNum=_useState20[0],setPageNum=_useState20[1];var _useState21=useState(1),_useState22=_slicedToArray(_useState21,2),maxPageNum=_useState22[0],setMaxPageNum=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),streetAddress=_useState24[0],setStreetAddress=_useState24[1];var _useState25=useState(moment(\"MMDDYYYY\")),_useState26=_slicedToArray(_useState25,2),apiDate=_useState26[0],setApiDate=_useState26[1];// eslint-disable-next-line\nvar markerOptions={clickable:true};// FETCH TO MAP MARKERS\n// FETCH CERTAIN DAY\nuseEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var data,resp;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"http://localhost:5000/event/\".concat(apiDate));case 2:data=_context3.sent;_context3.next=5;return data.json();case 5:resp=_context3.sent;setCoordinates(resp);console.log(\"EVENTS: \",resp);case 8:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchData.apply(this,arguments);}fetchData();},[apiDate]);// FETCH TO PAGINATE\nuseEffect(function(){function fetchData(){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var data,resp;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(\"http://localhost:5000/event/modal?page=\".concat(pageNum));case 2:data=_context4.sent;_context4.next=5;return data.json();case 5:resp=_context4.sent;setModalEvents(resp.data);setMaxPageNum(parseInt(resp.maxPageNum));case 8:case\"end\":return _context4.stop();}}},_callee4);}));return _fetchData2.apply(this,arguments);}fetchData();},[pageNum,coordinates]);useEffect(function(){function fetchData(){return _fetchData3.apply(this,arguments);}function _fetchData3(){_fetchData3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var data,resp;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\".concat(lat,\",\").concat(lng,\"&key=\").concat(process.env.REACT_APP_API_KEY));case 2:data=_context5.sent;_context5.next=5;return data.json();case 5:resp=_context5.sent;if(!(!resp.results||resp.results.length===0||!resp.results[0].formatted_address)){_context5.next=10;break;}return _context5.abrupt(\"return\",/*#__PURE__*/React.createElement(\"div\",null,\"Loading\"));case 10:setStreetAddress(resp.results[0].formatted_address);case 11:case\"end\":return _context5.stop();}}},_callee5);}));return _fetchData3.apply(this,arguments);}fetchData();},[lat,lng]);var goNextPage=function goNextPage(){setPageNum(pageNum+1);};var goPrevPage=function goPrevPage(){setPageNum(pageNum-1);};var eventShow=function eventShow(e){setPageNum(1);setEventList(e);};var deleteEvent=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e){var data,resp;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:e.preventDefault();_context6.next=3;return fetch(\"http://localhost:5000/event/\".concat(id),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"}});case 3:_context6.next=5;return fetch(\"http://localhost:5000/event/\".concat(apiDate));case 5:data=_context6.sent;_context6.next=8;return data.json();case 8:resp=_context6.sent;setCoordinates(resp);setRightClick(null);case 11:case\"end\":return _context6.stop();}}},_callee6);}));return function deleteEvent(_x3){return _ref3.apply(this,arguments);};}();// SHOW ALL EVENTS\nvar allEvents=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e){var data,resp;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return fetch(\"http://localhost:5000/event\");case 2:data=_context7.sent;_context7.next=5;return data.json();case 5:resp=_context7.sent;setCoordinates(resp);setRightClick(null);case 8:case\"end\":return _context7.stop();}}},_callee7);}));return function allEvents(_x4){return _ref4.apply(this,arguments);};}();// DOUBLE CLICk MAP\nvar onMapClick=useCallback(function(event){handleShow(event);},[]);var mapRef=React.useRef();var onMapLoad=React.useCallback(function(map){mapRef.current=map;});var panTo=useCallback(function(_ref5){var lat=_ref5.lat,lng=_ref5.lng;mapRef.current.panTo({lat:lat,lng:lng});mapRef.current.setZoom(16);},[]);var detailPanTo=useCallback(function(id){var lat=id.lat;var lng=id.lng;console.log(lng,lat);mapRef.current.panTo({lat:lat,lng:lng});mapRef.current.setZoom(16);setSelected(id);eventShow(false);},[]);if(loadError)return\"Error loading maps\";if(!isLoaded)return\"Loading Maps\";return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"blackBox\"},/*#__PURE__*/React.createElement(Navbar.Brand,{className:\"navText\"},\"JoinMe\",/*#__PURE__*/React.createElement(\"i\",{class:\"fas fa-users\"}))),/*#__PURE__*/React.createElement(Modal,{show:eventList,size:\"xl\"},/*#__PURE__*/React.createElement(Modal.Body,{className:\"eventModal\"},/*#__PURE__*/React.createElement(\"table\",{style:{width:\"100%\"}},/*#__PURE__*/React.createElement(\"tbody\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{width:25},\"Title:\"),/*#__PURE__*/React.createElement(\"td\",{width:25},\"Created by:\"),/*#__PURE__*/React.createElement(\"td\",{width:25},\"Date:\"),/*#__PURE__*/React.createElement(\"td\",{width:25},\"Details:\")),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:4},/*#__PURE__*/React.createElement(Dropdown.Divider,null))),modalEvents.map(function(id){return/*#__PURE__*/React.createElement(\"tr\",{key:id._id,style:{height:\"50px\"}},/*#__PURE__*/React.createElement(\"td\",{width:25},id.title),/*#__PURE__*/React.createElement(\"td\",{width:25},id.name),/*#__PURE__*/React.createElement(\"td\",{width:25},id.date),/*#__PURE__*/React.createElement(\"td\",{width:25},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return detailPanTo(id);}},\"Details\")));})))),/*#__PURE__*/React.createElement(Modal.Footer,{className:\"eventModal\"},/*#__PURE__*/React.createElement(\"table\",{style:{width:\"100%\"}},/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(PaginationLink,{disabled:pageNum===1,handleClick:goPrevPage},\"Previous Page\")),/*#__PURE__*/React.createElement(\"td\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(PaginationLink,{disabled:pageNum===maxPageNum,handleClick:goNextPage},\"Next Page\"))))),/*#__PURE__*/React.createElement(Button,{centered:true,style:{width:\"100%\",marginLeft:\"0\"},variant:\"secondary\",onClick:function onClick(){return eventShow(false);}},\"Close\"))),/*#__PURE__*/React.createElement(EventModal,{streetAddress:streetAddress,lng:lng,lat:lat,show:show,handleClose:handleClose,handleShow:handleShow,setCoordinates:setCoordinates,day:props.day,user:props.user,apiDate:apiDate}),/*#__PURE__*/React.createElement(Search,{panTo:panTo,searchShow:searchShow,lat:lat,lng:lng}),/*#__PURE__*/React.createElement(Locate,{panTo:panTo}),/*#__PURE__*/React.createElement(\"section\",{style:{width:\"100vw\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"pagination\"},/*#__PURE__*/React.createElement(Paginations,{setDay:props.setDay,setApiDate:setApiDate,allEvents:allEvents}))),/*#__PURE__*/React.createElement(GoogleMap,{mapContainerStyle:mapContainerStyle,zoom:14,center:center,options:options,onDblClick:onMapClick,onLoad:onMapLoad},coordinates.map(function(coordinate){return/*#__PURE__*/React.createElement(Marker,{options:markerOptions,key:coordinate._id,position:{lat:coordinate.lat,lng:coordinate.lng},icon:{url:\"/\".concat(props.user.name,\".png\"),scaledSize:new window.google.maps.Size(4,4,\"rem\",\"rem\"),shape:new window.google.maps.Circle(),origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(30,30)}// label={coordinate.title}\n,title:coordinate.title// POP UP EVENT DETAILS\n,onClick:function onClick(){setSelected(coordinate);setRightClick(null);},onRightClick:function onRightClick(){setId(coordinate._id);setRightClick(coordinate);setSelected(null);}});}),rightClick?/*#__PURE__*/React.createElement(InfoWindow,{position:{lat:rightClick.lat,lng:rightClick.lng},onCloseClick:function onCloseClick(){return setRightClick(null);}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{type:\"submit\",onClick:function onClick(e){return deleteEvent(e);}},\"Delete?\"))):null,selected?/*#__PURE__*/React.createElement(InfoWindow,{position:{lat:selected.lat,lng:selected.lng},onCloseClick:function onCloseClick(){return setSelected(null);}},/*#__PURE__*/React.createElement(\"table\",{style:{width:\"100%\"}},console.log(selected),/*#__PURE__*/React.createElement(\"tbody\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2},/*#__PURE__*/React.createElement(\"h5\",null,selected.title))),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2,style:{textAlign:\"left\"}},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Created by: \"),\" \",selected.name),/*#__PURE__*/React.createElement(\"hr\",null))),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2,style:{textAlign:\"left\"}},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Description: \"),\" \",selected.description))),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2,style:{textAlign:\"left\"}},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Date: \"),selected.date))),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{style:{textAlign:\"left\"}},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Start: \"),\" \",selected.startTime,\":00\")),/*#__PURE__*/React.createElement(\"td\",{style:{textAlign:\"left\"}},/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"End: \"),\" \",selected.endTime,\":00\"))),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:2},/*#__PURE__*/React.createElement(\"a\",{target:\"_blank\",href:\"https://www.google.com/maps/search/?api=1&query=\".concat(selected.lat,\",\").concat(selected.lng)},\"Open in Google Maps: \"),selected.address))))):null),/*#__PURE__*/React.createElement(LeftNav,{eventShow:eventShow}));}function Locate(_ref6){var panTo=_ref6.panTo;return/*#__PURE__*/React.createElement(\"button\",{className:\"locate\",onClick:function onClick(){navigator.geolocation.getCurrentPosition(function(position){panTo({lat:position.coords.latitude,lng:position.coords.longitude});},function(){return null;},options);}},/*#__PURE__*/React.createElement(\"i\",{class:\"far fa-compass\"}));}function Search(_ref7){var panTo=_ref7.panTo,searchShow=_ref7.searchShow,_lat=_ref7.lat,_lng=_ref7.lng;var _usePlacesAutocomplet=usePlacesAutocomplete({requestOptions:{location:{lat:function lat(){return _lat;},lng:function lng(){return _lng;}},radius:20*1000}}),ready=_usePlacesAutocomplet.ready,value=_usePlacesAutocomplet.value,_usePlacesAutocomplet2=_usePlacesAutocomplet.suggestions,status=_usePlacesAutocomplet2.status,data=_usePlacesAutocomplet2.data,setValue=_usePlacesAutocomplet.setValue,clearSuggestions=_usePlacesAutocomplet.clearSuggestions;return/*#__PURE__*/React.createElement(\"div\",{className:\"searchBar\"},/*#__PURE__*/React.createElement(Combobox,{onSelect:/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(address){var result,_yield$getLatLng,lat,lng;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:console.log(address);setValue(address,false);clearSuggestions();_context8.prev=3;_context8.next=6;return getGeocode({address:address});case 6:result=_context8.sent;_context8.next=9;return getLatLng(result[0]);case 9:_yield$getLatLng=_context8.sent;lat=_yield$getLatLng.lat;lng=_yield$getLatLng.lng;panTo({lat:lat,lng:lng});searchShow({lat:lat,lng:lng});setValue(\"\");_context8.next=20;break;case 17:_context8.prev=17;_context8.t0=_context8[\"catch\"](3);console.log(\"error\");case 20:case\"end\":return _context8.stop();}}},_callee8,null,[[3,17]]);}));return function(_x5){return _ref8.apply(this,arguments);};}()},/*#__PURE__*/React.createElement(ComboboxInput,{value:value,onChange:function onChange(e){setValue(e.target.value);},disabled:!ready,placeholder:\"Enter an address\"}),/*#__PURE__*/React.createElement(ComboboxPopover,null,/*#__PURE__*/React.createElement(ComboboxList,null,status===\"OK\"&&data.map(function(_ref9){var id=_ref9.id,description=_ref9.description;return/*#__PURE__*/React.createElement(ComboboxOption,{key:id,value:description});})))));}","map":{"version":3,"sources":["/Users/derek/Desktop/project/JoinMe-fe-DerekLarm/my-app/src/components/Map.js"],"names":["React","useState","useCallback","useEffect","Button","Navbar","Modal","Dropdown","GoogleMap","useLoadScript","Marker","InfoWindow","mapStyles","Paginations","EventModal","PaginationLink","LeftNav","usePlacesAutocomplete","getGeocode","getLatLng","Combobox","ComboboxInput","ComboboxPopover","ComboboxList","ComboboxOption","moment","libraries","mapContainerStyle","width","height","center","lat","lng","options","styles","disableDefaultUI","zoomControl","disableDoubleClickZoom","Map","props","show","setShow","setLat","setLng","handleShow","e","latLng","searchShow","handleClose","googleMapsApiKey","process","env","REACT_APP_API_KEY","isLoaded","loadError","coordinates","setCoordinates","selected","setSelected","rightClick","setRightClick","id","setId","eventList","setEventList","modalEvents","setModalEvents","pageNum","setPageNum","maxPageNum","setMaxPageNum","streetAddress","setStreetAddress","apiDate","setApiDate","markerOptions","clickable","fetchData","fetch","data","json","resp","console","log","parseInt","results","length","formatted_address","goNextPage","goPrevPage","eventShow","deleteEvent","preventDefault","method","headers","allEvents","onMapClick","event","mapRef","useRef","onMapLoad","map","current","panTo","setZoom","detailPanTo","textAlign","_id","title","name","date","marginLeft","day","user","setDay","coordinate","url","scaledSize","window","google","maps","Size","shape","Circle","origin","Point","anchor","description","startTime","endTime","address","Locate","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","Search","requestOptions","location","radius","ready","value","suggestions","status","setValue","clearSuggestions","result","target"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from \"react\";\nimport { Button, Navbar, Modal, Dropdown } from \"react-bootstrap\";\nimport {\n  GoogleMap,\n  useLoadScript,\n  Marker,\n  InfoWindow,\n} from \"@react-google-maps/api\";\n// import { formatRelative } from \"date-fns\";\nimport mapStyles from \"../mapStyles\";\nimport { Paginations, EventModal, PaginationLink, LeftNav } from \"./index\";\n// import App from \"../App\";\nimport usePlacesAutocomplete, {\n  getGeocode,\n  getLatLng,\n} from \"use-places-autocomplete\";\nimport {\n  Combobox,\n  ComboboxInput,\n  ComboboxPopover,\n  ComboboxList,\n  ComboboxOption,\n} from \"@reach/combobox\";\nimport \"@reach/combobox/styles.css\";\nimport moment from \"moment\";\n\nconst libraries = [\"places\"];\nconst mapContainerStyle = {\n  width: \"100%\",\n  height: \"100vh\",\n};\nconst center = {\n  lat: 10.785478,\n  lng: 106.696847,\n};\nconst options = {\n  styles: mapStyles,\n  disableDefaultUI: true,\n  zoomControl: true,\n  disableDoubleClickZoom: true,\n};\n\nexport default function Map(props) {\n  const [show, setShow] = useState(false);\n  const [lat, setLat] = useState(10.785478);\n  const [lng, setLng] = useState(106.696847);\n\n  const handleShow = async (e) => {\n    await setLat(e.latLng.lat());\n    await setLng(e.latLng.lng());\n    setShow(true);\n    // reverseGeo();\n  };\n\n  const searchShow = async (e) => {\n    setLat(e.lat);\n    setLng(e.lng);\n    setShow(true);\n  };\n\n  const handleClose = () => {\n    setShow(false);\n  };\n  const { isLoaded, loadError } = useLoadScript({\n    googleMapsApiKey: process.env.REACT_APP_API_KEY,\n    libraries,\n  });\n\n  const [coordinates, setCoordinates] = useState([]);\n  const [selected, setSelected] = useState(null);\n  const [rightClick, setRightClick] = useState(null);\n  const [id, setId] = useState(null);\n  const [eventList, setEventList] = useState(null);\n  const [modalEvents, setModalEvents] = useState([]);\n  const [pageNum, setPageNum] = useState(1);\n  const [maxPageNum, setMaxPageNum] = useState(1);\n  const [streetAddress, setStreetAddress] = useState(\"\");\n  const [apiDate, setApiDate] = useState(moment(\"MMDDYYYY\"));\n  // eslint-disable-next-line\n\n  const markerOptions = {\n    clickable: true,\n  };\n\n  // FETCH TO MAP MARKERS\n\n  // FETCH CERTAIN DAY\n  useEffect(() => {\n    async function fetchData() {\n      const data = await fetch(`http://localhost:5000/event/${apiDate}`);\n      const resp = await data.json();\n      setCoordinates(resp);\n      console.log(\"EVENTS: \", resp);\n    }\n    fetchData();\n  }, [apiDate]);\n\n  // FETCH TO PAGINATE\n  useEffect(() => {\n    async function fetchData() {\n      const data = await fetch(\n        `http://localhost:5000/event/modal?page=${pageNum}`\n      );\n      const resp = await data.json();\n      setModalEvents(resp.data);\n      setMaxPageNum(parseInt(resp.maxPageNum));\n    }\n    fetchData();\n  }, [pageNum, coordinates]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const data = await fetch(\n        `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=${process.env.REACT_APP_API_KEY}`\n      );\n      const resp = await data.json();\n      if (\n        !resp.results ||\n        resp.results.length === 0 ||\n        !resp.results[0].formatted_address\n      ) {\n        return <div>Loading</div>;\n      } else {\n        setStreetAddress(resp.results[0].formatted_address);\n      }\n    }\n    fetchData();\n  }, [lat, lng]);\n\n  const goNextPage = () => {\n    setPageNum(pageNum + 1);\n  };\n\n  const goPrevPage = () => {\n    setPageNum(pageNum - 1);\n  };\n\n  const eventShow = (e) => {\n    setPageNum(1);\n    setEventList(e);\n  };\n\n  const deleteEvent = async (e) => {\n    e.preventDefault();\n    await fetch(`http://localhost:5000/event/${id}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const data = await fetch(`http://localhost:5000/event/${apiDate}`);\n    const resp = await data.json();\n    setCoordinates(resp);\n    setRightClick(null);\n  };\n\n  // SHOW ALL EVENTS\n  const allEvents = async (e) => {\n    const data = await fetch(\"http://localhost:5000/event\");\n    const resp = await data.json();\n    setCoordinates(resp);\n    setRightClick(null);\n  };\n\n  // DOUBLE CLICk MAP\n  const onMapClick = useCallback((event) => {\n    handleShow(event);\n  }, []);\n\n  const mapRef = React.useRef();\n  const onMapLoad = React.useCallback((map) => {\n    mapRef.current = map;\n  });\n\n  const panTo = useCallback(({ lat, lng }) => {\n    mapRef.current.panTo({ lat, lng });\n    mapRef.current.setZoom(16);\n  }, []);\n\n  const detailPanTo = useCallback((id) => {\n    const lat = id.lat;\n    const lng = id.lng;\n    console.log(lng, lat);\n    mapRef.current.panTo({ lat, lng });\n    mapRef.current.setZoom(16);\n    setSelected(id);\n    eventShow(false);\n  }, []);\n\n  if (loadError) return \"Error loading maps\";\n  if (!isLoaded) return \"Loading Maps\";\n\n  return (\n    <div>\n      <div className=\"blackBox\">\n        <Navbar.Brand className=\"navText\">\n          JoinMe<i class=\"fas fa-users\"></i>\n        </Navbar.Brand>\n      </div>\n      <Modal show={eventList} size=\"xl\">\n        <Modal.Body className=\"eventModal\">\n          <table style={{ width: \"100%\" }}>\n            <tbody style={{ textAlign: \"center\" }}>\n              <tr>\n                <td width={25}>Title:</td>\n                <td width={25}>Created by:</td>\n                <td width={25}>Date:</td>\n                <td width={25}>Details:</td>\n              </tr>\n              <tr>\n                <td colSpan={4}>\n                  <Dropdown.Divider />\n                </td>\n              </tr>\n\n              {modalEvents.map((id) => (\n                <tr key={id._id} style={{ height: \"50px\" }}>\n                  <td width={25}>{id.title}</td>\n                  <td width={25}>{id.name}</td>\n                  <td width={25}>{id.date}</td>\n                  <td width={25}>\n                    <Button onClick={() => detailPanTo(id)}>Details</Button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </Modal.Body>\n        <Modal.Footer className=\"eventModal\">\n          <table style={{ width: \"100%\" }}>\n            <tbody>\n              <tr>\n                <td style={{ textAlign: \"center\" }}>\n                  <PaginationLink\n                    disabled={pageNum === 1}\n                    handleClick={goPrevPage}\n                  >\n                    Previous Page\n                  </PaginationLink>\n                </td>\n                <td style={{ textAlign: \"center\" }}>\n                  <PaginationLink\n                    disabled={pageNum === maxPageNum}\n                    handleClick={goNextPage}\n                  >\n                    Next Page\n                  </PaginationLink>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n\n          <Button\n            centered\n            style={{ width: \"100%\", marginLeft: \"0\" }}\n            variant=\"secondary\"\n            onClick={() => eventShow(false)}\n          >\n            Close\n          </Button>\n        </Modal.Footer>\n      </Modal>\n      {/* CREATE EVENT MODAL */}\n      <EventModal\n        streetAddress={streetAddress}\n        lng={lng}\n        lat={lat}\n        show={show}\n        handleClose={handleClose}\n        handleShow={handleShow}\n        setCoordinates={setCoordinates}\n        day={props.day}\n        user={props.user}\n        apiDate={apiDate}\n      />\n      <Search panTo={panTo} searchShow={searchShow} lat={lat} lng={lng} />\n      <Locate panTo={panTo} />\n      <section style={{ width: \"100vw\" }}>\n        <div className=\"pagination\">\n          <Paginations\n            setDay={props.setDay}\n            setApiDate={setApiDate}\n            allEvents={allEvents}\n          />\n        </div>\n      </section>\n\n      <GoogleMap\n        mapContainerStyle={mapContainerStyle}\n        zoom={14}\n        center={center}\n        options={options}\n        onDblClick={onMapClick}\n        onLoad={onMapLoad}\n      >\n        {coordinates.map((coordinate) => (\n          <Marker\n            options={markerOptions}\n            key={coordinate._id}\n            position={{ lat: coordinate.lat, lng: coordinate.lng }}\n            icon={{\n              url: `/${props.user.name}.png`,\n              scaledSize: new window.google.maps.Size(4, 4, \"rem\", \"rem\"),\n              shape: new window.google.maps.Circle(),\n              origin: new window.google.maps.Point(0, 0),\n              anchor: new window.google.maps.Point(30, 30),\n            }}\n            // label={coordinate.title}\n            title={coordinate.title}\n            // POP UP EVENT DETAILS\n            onClick={() => {\n              setSelected(coordinate);\n              setRightClick(null);\n            }}\n            onRightClick={() => {\n              setId(coordinate._id);\n              setRightClick(coordinate);\n              setSelected(null);\n            }}\n          ></Marker>\n        ))}\n        {rightClick ? (\n          <InfoWindow\n            position={{ lat: rightClick.lat, lng: rightClick.lng }}\n            onCloseClick={() => setRightClick(null)}\n          >\n            <div>\n              <Button type=\"submit\" onClick={(e) => deleteEvent(e)}>\n                Delete?\n              </Button>\n            </div>\n          </InfoWindow>\n        ) : null}\n        {selected ? (\n          <InfoWindow\n            position={{ lat: selected.lat, lng: selected.lng }}\n            onCloseClick={() => setSelected(null)}\n          >\n            <table style={{ width: \"100%\" }}>\n              {console.log(selected)}\n              <tbody style={{ textAlign: \"center\" }}>\n                <tr>\n                  <td colSpan={2}>\n                    <h5>{selected.title}</h5>\n                  </td>\n                </tr>\n                <tr>\n                  <td colSpan={2} style={{ textAlign: \"left\" }}>\n                    <p>\n                      <b>Created by: </b> {selected.name}\n                    </p>\n                    <hr />\n                  </td>\n                </tr>\n\n                <tr>\n                  <td colSpan={2} style={{ textAlign: \"left\" }}>\n                    <p>\n                      <b>Description: </b> {selected.description}\n                    </p>\n                  </td>\n                </tr>\n                <tr>\n                  <td colSpan={2} style={{ textAlign: \"left\" }}>\n                    <p>\n                      <b>Date: </b>\n                      {selected.date}\n                    </p>\n                  </td>\n                </tr>\n                <tr>\n                  <td style={{ textAlign: \"left\" }}>\n                    <p>\n                      <b>Start: </b> {selected.startTime}:00\n                    </p>\n                  </td>\n                  <td style={{ textAlign: \"left\" }}>\n                    <p>\n                      <b>End: </b> {selected.endTime}:00\n                    </p>\n                  </td>\n                </tr>\n                <tr>\n                  <td colSpan={2}>\n                    <a\n                      target=\"_blank\"\n                      href={`https://www.google.com/maps/search/?api=1&query=${selected.lat},${selected.lng}`}\n                    >\n                      {`Open in Google Maps: `}\n                    </a>\n                    {selected.address}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </InfoWindow>\n        ) : null}\n      </GoogleMap>\n      <LeftNav eventShow={eventShow} />\n      {/* <Button onClick={() => reverseGeo()}>REversee</Button> */}\n    </div>\n  );\n}\n\nfunction Locate({ panTo }) {\n  return (\n    <button\n      className=\"locate\"\n      onClick={() => {\n        navigator.geolocation.getCurrentPosition(\n          (position) => {\n            panTo({\n              lat: position.coords.latitude,\n              lng: position.coords.longitude,\n            });\n          },\n          () => null,\n          options\n        );\n      }}\n    >\n      <i class=\"far fa-compass\"></i>\n    </button>\n  );\n}\n\nfunction Search({ panTo, searchShow, lat, lng }) {\n  const {\n    ready,\n    value,\n    suggestions: { status, data },\n    setValue,\n    clearSuggestions,\n  } = usePlacesAutocomplete({\n    requestOptions: {\n      location: { lat: () => lat, lng: () => lng },\n      radius: 20 * 1000,\n    },\n  });\n  return (\n    <div className=\"searchBar\">\n      <Combobox\n        onSelect={async (address) => {\n          console.log(address);\n          setValue(address, false);\n          clearSuggestions();\n          try {\n            const result = await getGeocode({ address });\n            const { lat, lng } = await getLatLng(result[0]);\n            panTo({ lat, lng });\n            searchShow({ lat, lng });\n            setValue(\"\");\n          } catch (error) {\n            console.log(\"error\");\n          }\n        }}\n      >\n        <ComboboxInput\n          value={value}\n          onChange={(e) => {\n            setValue(e.target.value);\n          }}\n          disabled={!ready}\n          placeholder=\"Enter an address\"\n        />\n        <ComboboxPopover>\n          <ComboboxList>\n            {status === \"OK\" &&\n              data.map(({ id, description }) => (\n                <ComboboxOption key={id} value={description} />\n              ))}\n          </ComboboxList>\n        </ComboboxPopover>\n      </Combobox>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}